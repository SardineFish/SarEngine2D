<!DOCTYPE HTML><html>    <head>        <title>Test</title><script src="jquery.min.js"></script>        <script src="../SardineFish.Web.js"></script>        <script src="../SardineFish.Web.Engine2D.js"></script>        <meta name="viewport" content="width=device-width,initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no,target-densitydpi=device-dpi" />        <meta name="apple-mobile-web-app-capable" content="yes" />        <meta name="browsermode" content="application" />        <meta name="full-screen" content="true" />        <meta name="x5-fullscreen" content="true" />        <meta name="x5-page-mode" content="app" />        <meta name="360-fullscreen" content="true" />        <style>            html{                -ms-touch-action: none;  /*Direct all pointer events to JavaScript code. */                /*overflow: hidden;*/            }            body{                margin: 0px;                padding: 0px;                background-color: rgb(240,240,240);            }            #debug{                display: block;                position: fixed;                 top: -10px;                left: 0px;                z-index: 1000;                color: red;            }            #textCount{                display: none;            }        </style>    </head>    <body oncontextmenu="return false;"><!--        <a href="http://cdn.bootcss.com/jquery/2.1.4/jquery.min.js" download="jquery.min.js" >jquery.min.js</a>        -->        <p id="debug" >debug</p>        <p id="textCount">0</p>        <div>            <canvas id="canvas" width="480" height="500"></canvas>            <div style="height: 200px; background-color:black"></div>        </div>                <script>try{//call SardineFish;//alert(Engine2D.Web);var width=0,height=0;var lastP=false;//alert(LinkList);var canvas=document.getElementById("canvas");Graphics.canvas = canvas;var lineList=new Array();var pList=[];var lastLine=false;var lastCol=false;var calcu=false;var O=false;var scene = new Scene;var camera = new Camera(width / 2, height / 2, width, height, 1.0);camera.graphics = new Graphics(canvas);scene.camera = camera;var game = new Game.createByCanvas(canvas);game.setScene(scene);var controlMan = null;var runing = false;var moving = false;scene.physics.g.y=360;scene.onClick=canvasClick0;scene.onDoubleClick=function(e){    //alert("");}scene.onKeyDown = function (e){    if (e.key == "s" || e.key == "S" || e.key == "Down")    {        controlMan.graphic = crouchAnimation.copy();        controlMan.v.x = 0;        controlMan.graphic.setCenter(controlMan.position.x, controlMan.position.y, Align.bottomCenter);        moving = true;    }    if (e.key == "d" || e.key == "D" || e.key == "Right")    {        controlMan.graphic = walkAnimation.copy();        controlMan.v.x = 100;        controlMan.graphic.setCenter(controlMan.position.x, controlMan.position.y, Align.bottomCenter);        moving = true;    }    if (e.key  == "Shift")    {        if (!moving)            return;        controlMan.graphic = runAnimation.copy();        controlMan.v.x = 500;        controlMan.graphic.setCenter(controlMan.position.x, controlMan.position.y, Align.bottomCenter);        runing = true;    }}scene.onKeyUp = function (e){    if (e.key == "d" || e.key == "D" || e.key == "Right")    {        controlMan.graphic = standAnimation.copy();        controlMan.v.x = 0;        controlMan.graphic.setCenter(controlMan.position.x, controlMan.position.y, Align.bottomCenter);        runing = false;        moving = false;    }    if (e.key == "Shift")    {        if (moving)        {            controlMan.graphic = walkAnimation.copy();            controlMan.v.x = 100;            controlMan.graphic.setCenter(controlMan.position.x, controlMan.position.y, Align.bottomCenter);        }        else        {            controlMan.graphic = standAnimation.copy();            controlMan.v.x = 0;            controlMan.graphic.setCenter(controlMan.position.x, controlMan.position.y, Align.bottomCenter);        }        runing = false;    }}var rect=new Rectangle(64,136);var walkAnimation;var standAnimation;var runAnimation;var crouchAnimation;var jumpAnimation;function resize(){    width=screen.availWidth;    height =screen.availHeight;//alert("("+width+","+height+")");    $("body").css("width",width.toString()+"px");    document.getElementById("canvas").width=width;    document.getElementById("canvas").height=height;    }resize();function drawLine(x1,y1,x2,y2){    ctx=canvas.getContext("2d");    ctx.beginPath();    ctx.moveTo(x1,y1);    ctx.lineTo(x2,y2);    ctx.strokeStyle="white";    ctx.stroke();}function canvasUp(e){    }function onUpdate(obj,delay){try{    obj.collider.drawToCanvas(canvas,0,0,delay);    }catch(ex){ alert("update:"+ex.message);}}function onRender(obj,delay){try{//alert();    obj.collider.drawToCanvas(canvas,0,0,delay);    }catch(ex){ alert("render:"+ex.message);}}function canvasClick0(e){try{    var ground=new Ground(height,height);      var g=ground.toGameObject();    scene.addGameObject(g);    var wall =new Rectangle(10,height);    wall.rigidBody=true;    wall.static=true;    wall.soft=false;    var wo=new GameObject();    wo.collider=wall.copy();    wo.graphic=wo.collider;    wo.collider.setCenter(0,height,Align.bottomCenter);    wo.gravity=false;    scene.addGameObject(wo);    wo=new GameObject();    wo.collider=wall.copy();    wo.graphic=wo.collider;    wo.collider.setCenter(width,height,Align.bottomCenter);    wo.gravity=false;    scene.addGameObject(wo);    var top=new Rectangle(width,10);    top.rigidBody=true;    top.static=true;    top.soft=false;    var to=new GameObject();    to.collider=top;    to.graphic=top;    to.gravity=false;    top.setCenter(0,0,Align.middleLeft);    scene.addGameObject(to);    //alert(g.id);    var p = new Point(e.pageX, e.pageY);    var obj = new GameObject();    obj.graphic = rect.copy();    obj.collider=obj.graphic;    obj.collider.static=true    obj.collider.rigidBody=true;    obj.collider.soft=false;    obj.graphic.setCenter(p.x, p.y, Align.bottomCenter);    obj.setCenter(p.x, p.y);    obj.name = "animation";    obj.onUpdate = onUpdate;    obj.mass=1;    obj.gravity=false;    controlMan = obj;    scene.addGameObject(obj);    obj.name = "animation" + obj.id;    $("#textCount").text(pList.length.toString());    scene.onClick=canvasClick;     }catch(ex){ alert("click0:"+ex.message);}//alert(obj.name);}function canvasClick(e){    try    {        var p = new Point(e.pageX, e.pageY);            var obj = new GameObject();        obj.graphic = standAnimation.copy();        obj.collider=rect.copy();        obj.collider.setCenter(p.x, p.y, Align.bottomCenter);        obj.collider.rigidBody=true;        obj.collider.bounce=0;        //obj.collider.soft=false;        obj.graphic.setCenter(p.x, p.y, Align.bottomCenter);        obj.setCenter(p.x, p.y);        obj.name = "animation";        obj.onUpdate = onUpdate;        obj.onRender=onRender;        obj.mass=1;        //obj.gravity=false;        //obj.collider.static=true;        obj.v.x=controlMan.position.x-obj.position.x;        obj.v.y=controlMan.position.y-obj.position.y;        scene.addGameObject(obj);        obj.name = "animation" + obj.id;        controlMan=obj;    }catch(ex){alert(ex.message);}}window.onload=function(e){    try    {        walkAnimation = new ImageAnimation();        walkAnimation = ImageAnimation.loadFromUrl("walk.png", 0, 0, 160, 350,64,140, 18, 30, function ()        {        });        standAnimation = ImageAnimation.loadFromUrl("stand.png", 0, 0, 160, 350, 64, 140, 1, 1);        runAnimation = ImageAnimation.loadFromUrl("run.png", 0, 0, 260, 340, 104, 136, 27, 20, function () { runAnimation.loop.from = 13;});        runAnimation.loop.from = 12;        crouchAnimation = ImageAnimation.loadFromUrl("crouch.png", 0, 0, 200, 340, 80, 136, 11, 30, function ()        {            crouchAnimation.loop.enable = false;        });        jumpAnimation = ImageAnimation.loadFromUrl("jump.png", 0, 0, 220, 350, 88, 140, 11, 30, function ()        {            jumpAnimation.loop.enable = false;        });    var ctx=document.getElementById("canvas").getContext("2d");    //alert(ctx);    ctx.fillRect(0,0,width,height);        $("#canvas").mouseup(canvasUp);    SardineFish.Web.Engine2D.debug.write=function(text)    {//alert(text);        $("#debug").text(text);    }    SardineFish.Web.Engine2D.debug.clear=function()    {        $("#debug").text("");    }    game.start();}catch(ex){alert("onLoaded:"+ex.message);}}}catch(ex){    alert("global:"+ex.message);}        </script>    </body></html>