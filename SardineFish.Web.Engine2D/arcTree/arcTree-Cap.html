<!DOCTYPE HTML><html>    <head>        <title>ArcTree Cap</title>        <script src="jquery.min.js"></script>        <script src="SardineFish.Web.js"></script>        <script src="SardineFish.Web.UI.js"></script>        <script src="SardineFish.Web.Engine2D.js"></script>        <script src="SardineFish.Web.Engine2D.Colliders.js"></script>        <script src="SardineFish.Web.Engine2D.GUI.js"></script><!--        <meta name="viewport" content="width=device-width,initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no,target-densitydpi=device-dpi" />        <meta name="apple-mobile-web-app-capable" content="yes" />        <meta name="browsermode" content="application" />        <meta name="full-screen" content="true" />        <meta name="x5-fullscreen" content="true" />        <meta name="x5-page-mode" content="app" />        <meta name="360-fullscreen" content="true" />-->        <style>html{    /*-ms-touch-action: none;     overflow: hidden;*/}body{    padding: 0px;    margin:0px;    background-color: #F0F0F0;}#canvas{    background-color: white;}#player{    border: solid 1px rgba(0,0,0,0.2);}        </style>    </head>    <body>        <canvas id="canvas" width="800" height="480"/>        <video id="player">                    </video>    </body>    <script>try{    var canvas=$("canvas").get(0);    var player=$("#player").get(0);    var stream=canvas.captureStream(30);    play.src=URL.createObjectURL(stream);    var graphics=canvas.getContext("2d");//new Graphics(canvas);    /*var camera=new camera(0,0,0,0,1);    camera.graphics=graphics;    camera.applyTransform();*/    var PI=Math.PI;    var tan=Math.tan;    var k=0.667;    var lk=k/(k+1);    var ang=5*PI/6;    var lineList=[];    lineList[0]=new Line(new Point(400,480),new Point(400,240));    lineList[0].ang=PI/2;    lineList[0].strokeStyle="black";    //lineList[0].render(graphics);    var nextList=[];    var arcLList=[];    var arcRList=[];    function animate()    {        var dt=15/1000;        var dAng=0;        function frame()        {            //alert(dAng);            dAng+=dt*ang;            if(dAng>ang)                dAng=ang;            for(var i=0;i<arcLList.length;i++)            {                arcLList[i].end=arcLList[i].start-dAng;                arcRList[i].end=arcRList[i].start+dAng;                arcLList[i].render(graphics);                arcRList[i].render(graphics);            }            if(dAng==ang)                next();            else                requestAnimationFrame(frame);        }        var id=requestAnimationFrame(frame);        //alert(id);    }    function next()    {        try{        nextList=[];        arcLList=[];        arcRList=[];        for(var i=0;i<lineList.length;i++)        {            var line=lineList[i];            var v=Vector2.fromPoint(line.p1,line.p2);            var vl=Vector2.multi(v,k);            var vr=Vector2.multi(v,k);            //alert(vl);            vl.rotate(-ang);            //alert(vl);            vr.rotate(ang);            var lineL=new Line(line.p2,new Point(line.p2.x+vl.x,line.p2.y+vl.y));            var lineR=new Line(line.p2,new Point(line.p2.x+vr.x,line.p2.y+vr.y));            lineL.ang=line.ang-ang;            lineR.ang=line.ang+ang;            nextList.add(lineL);            nextList.add(lineR);            vl=Vector2.multi(v,lk*tan((PI-ang)/2));            vr=Vector2.multi(v,lk*tan((PI-ang)/2));            vl.rotate(-PI/2);            vr.rotate(PI/2);            rl=vl.toLine((line.p2.x-line.p1.x)*(1-lk)+line.p1.x,(line.p2.y-line.p1.y)*(1-lk)+line.p1.y);            rr=vr.toLine(rl.p1.x,rl.p1.y);            var ol=rl.p2;            var or=rr.p2;            var r=vl.mod();            var arcL=new Arc(ol,r,line.ang-(PI/2),line.ang-(PI/2)-ang,true);            var arcR=new Arc(or,r,line.ang+(PI/2),line.ang+(PI/2)+ang,false);            arcLList.add(arcL);            arcRList.add(arcR);            //arcL.render(graphics);            //arcR.render(graphics);                        /*rl.strokeStyle="blue";            rr.strokeStyle="red";            rl.render(graphics);            rr.render(graphics);                        lineR.strokeStyle=Color.random();            lineL.strokeStyle=Color.random();            lineL.render(graphics);            lineR.render(graphics);*/        }        lineList=nextList;        //setTimeout(next,1000);                animate();        }catch(ex){alert("next:"+i+ex.message);}    }    next();}catch(ex){    alert("global:"+ex.message);}    </script></html>